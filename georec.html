<!doctype html>
<html>
    <head>
        <script>
            const execPositionLoop = () => {
                navigator.geolocation.getCurrentPosition((position) => {
                    document.querySelector('#content').innerText = `@@@@@@@@@@@@@@@.    latitude: ${position.coords.latitude}; longitude: ${position.coords.longitude};`
                    setTimeout(execPositionLoop, 500)
                });
            }
            
            const handleOrientationEvent = event => {
                // alpha: rotation around z-axis
                var rotateDegrees = event.alpha;
                // gamma: left to right
                var leftToRight = event.gamma;
                // beta: front back motion
                var frontToBack = event.beta;

                document.querySelector('#orientation').innerText = `rotateDegrees: ${rotateDegrees}; leftToRight: ${leftToRight}; frontToBack: ${frontToBack}`
            }
            
            const handleMotionEvent = event => {
                var x = event.accelerationIncludingGravity.x;
                var y = event.accelerationIncludingGravity.y;
                var z = event.accelerationIncludingGravity.z;

                document.querySelector('#motion').innerText = `x: ${x}; y: ${y}; z: ${z}`
            }

            const initOrientationListener = () => {
                window.addEventListener("deviceorientation", handleOrientationEvent, true);
            }
            
            const getPermissionsAndCall = (Device, callback) => {
                if (typeof Device.requestPermission === "function") {
                    Device.requestPermission()
                        .then(permissionState => {
                            if (permissionState === "granted") {
                                callback()
                            }
                        })
                        .catch(console.error);
                } else {
                    callback()
                }
            }
            
            window.onload = () => {
                getPermissionsAndCall(DeviceOrientationEvent, initOrientationListener)
                getPermissionsAndCall(DeviceMotionEvent, initOrientationListener)
                execPositionLoop()
            }
        </script>
  </head>

    <body style="margin: 0; overflow: hidden;">
      <div id="content"></div>
      <div id="motion"></div>
      <div id="orientation"></div>
    </body>
</html>
